# 📊 데이터 이식 가이드 (노트북 ↔ 컴퓨터) - 2025년 8월 11일

## 🎯 **목적**
이 문서는 아동학습센터 시스템을 노트북과 컴퓨터 간에 데이터를 동기화하고 관리하는 방법을 설명합니다.

## 🔄 **마이그레이션 시스템**

### **개발 단계에서 스키마 변경 시**
```bash
# 1. 스키마 변경사항 추적
flask db migrate -m "변경사항 설명"

# 2. 변경사항을 데이터베이스에 적용
flask db upgrade

# 3. 필요시 이전 버전으로 되돌리기
flask db downgrade
```

### **마이그레이션 파일 관리**
- `migrations/versions/` 폴더에 모든 마이그레이션 파일이 저장됩니다
- 이 파일들을 Git에 커밋하여 버전 관리에 포함시킵니다
- 새로운 환경에서는 `flask db upgrade`로 최신 스키마를 적용합니다

## 🌱 **데이터 시드 시스템**

### **개발용 시드 데이터**
```bash
# 웹 UI에서 실행
설정 → 데이터 관리 → 시드 데이터 실행

# 또는 터미널에서 실행
python seed_data.py
```

### **실제 운영용 시드 데이터**
1. `seed_data.py` 파일을 열어서 아동 이름을 실제 이름으로 수정
2. 포인트 값을 실제 누적 포인트로 수정
3. `python seed_data.py` 실행

## 💾 **데이터 이식 방법**

### **방법 1: 데이터베이스 파일 직접 복사 (권장)**
```bash
# 1. 현재 데이터베이스 파일 백업
copy child_center.db child_center_backup.db

# 2. 다른 기기로 파일 복사
# USB, 클라우드, 네트워크 등을 통해 전송

# 3. 새 기기에서 파일 교체
copy child_center.db child_center.db
```

**장점:**
- 가장 빠르고 안전함
- 모든 데이터가 그대로 유지됨
- 복잡한 설정 불필요

**주의사항:**
- 두 기기에서 동시에 사용하면 데이터 충돌 가능성
- 파일 크기가 클 수 있음

### **방법 2: 시드 스크립트로 데이터 재생성**
```bash
# 1. seed_data.py에서 실제 데이터로 수정
# 2. 새 기기에서 실행
python seed_data.py
```

**장점:**
- 개인정보 보호 (실제 이름만 수정)
- 데이터 일관성 보장
- 버전 관리 가능

**단점:**
- 수동으로 데이터 입력 필요
- 시간이 오래 걸림

### **방법 3: 마이그레이션 + 시드 조합**
```bash
# 1. 스키마 동기화
flask db upgrade

# 2. 기본 데이터 생성
python seed_data.py

# 3. 실제 데이터 수동 입력
# 웹 UI를 통해 아동 정보와 포인트 입력
```

## 🚀 **실제 운영 시나리오**

### **시나리오 1: 새로운 기기에 시스템 설치**
```bash
# 1. 코드 복사
git clone [repository] 또는 파일 복사

# 2. 가상환경 설정
python -m venv .venv
.venv\Scripts\activate  # Windows
source .venv/bin/activate  # Mac/Linux

# 3. 의존성 설치
pip install -r requirements.txt

# 4. 데이터베이스 생성
flask db upgrade

# 5. 실제 데이터 입력
# seed_data.py 수정 후 실행 또는 웹 UI 사용
```

### **시나리오 2: 기존 데이터 백업 및 복원**
```bash
# 1. 백업
copy child_center.db backup_$(date +%Y%m%d).db

# 2. 복원
copy backup_20241201.db child_center.db
```

### **시나리오 3: 스키마 업데이트 후 데이터 마이그레이션**
```bash
# 1. 코드 업데이트
git pull 또는 파일 교체

# 2. 마이그레이션 적용
flask db upgrade

# 3. 데이터 무결성 확인
python -c "from app import app, db; app.app_context().push(); print('데이터 확인 완료')"
```

## ⚠️ **주의사항 및 모범 사례**

### **데이터 안전성**
- **항상 백업을 먼저 생성**하세요
- 중요한 변경 전에 테스트 환경에서 먼저 시험해보세요
- 데이터베이스 파일을 직접 수정하지 마세요

### **동시 사용 방지**
- 한 번에 하나의 기기에서만 데이터를 수정하세요
- 데이터 이식 중에는 다른 기기에서 사용하지 마세요

### **버전 관리**
- 마이그레이션 파일을 Git에 커밋하세요
- `requirements.txt`를 최신 상태로 유지하세요
- 환경별 설정 파일을 분리하세요

## 🔧 **문제 해결**

### **일반적인 오류**
```bash
# 오류: "No such command 'db'"
pip install flask-migrate

# 오류: "Directory migrations already exists"
# 정상입니다. 계속 진행하세요

# 오류: "No changes in schema detected"
# 스키마가 이미 최신 상태입니다
```

### **데이터 복구**
```bash
# 1. 백업 파일 확인
dir *.db

# 2. 최신 백업으로 복원
copy child_center_backup_20241201.db child_center.db

# 3. 시스템 재시작
```

## 📋 **체크리스트**

### **데이터 이식 전**
- [ ] 현재 데이터 백업 완료
- [ ] 두 기기 모두 시스템 중지
- [ ] 마이그레이션 파일 동기화
- [ ] 시드 스크립트 준비 완료

### **데이터 이식 중**
- [ ] 백업 파일 안전하게 전송
- [ ] 새 기기에서 파일 교체
- [ ] 시스템 시작 및 테스트
- [ ] 데이터 무결성 확인

### **데이터 이식 후**
- [ ] 두 기기 모두 정상 작동 확인
- [ ] 백업 파일 보관
- [ ] 다음 이식 일정 계획

## 📞 **지원 및 문의**

문제가 발생하거나 추가 도움이 필요한 경우:
1. 이 가이드 문서를 다시 확인
2. 시스템 로그 확인
3. 백업 파일로 복구 시도
4. 개발자에게 문의

---

**마지막 업데이트:** 2024년 12월 1일  
**버전:** 1.0  
**작성자:** 개발팀
